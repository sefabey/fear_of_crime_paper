---
title: "Lexicon of Crime and Police Words"
author: "Sefa Ozalp"
date: "26/07/2018"
output: html_document
---

```{r}
library(tidyverse)
library(rhymer)
```

# Lexicon Paragraph
We compiled a list of 51 seeding words which includes words used when expressing fear of crime, different crime types and British slangs referring to police and criminal activity (find this list online [https://github.com/sefabey/fear_of_crime_paper/blob/master/data/FOC_seed_words.csv]). The seed list was used to create the lexicon by querying the Datamuse API -a word-finding engine which allows for querying rhyming words, similar spellings and semantically similar or contextually related words using multiple contraints such as synonyms, perfect and approximate rhymes, homophones, frequent followers, direct holonyms. Using the rhymer package (Landesberg 2017) in R, we queried Datamuse API for the first 100 words that 'means like' -i.e. words or sequence of words that are conceptually, semantically and lexically related to- the words in the seed list. After removing duplicates and manually removing clearly out of context results (such as query:coppers, Datamuse result:atomic number 29), we collated a lexicon consisting of 3096 words (find this file online [https://github.com/sefabey/fear_of_crime_paper/blob/master/data/FOC_lexicon_001_manual_edited.csv]). 

This lexicon was used to filter the 20m tweets in the dataset... (amir)

```{r}

seed_list <- read_csv("../data/FOC_seed_words.csv")
seed_list %>% distinct(words) #51 distinct words
```

```{r}

query_datamuse <- function(x, ...){
    rhymer::get_means_like(word = x, ...)
}

crime_fear_lexicon <- seed_list %>% 
    select(words) %>%
    pull() %>%  
    map_df(query_datamuse, limit=100, .id = "id") %>% #5030 results
    mutate(id=as.integer(id)) %>% 
    distinct(word, .keep_all = T) %>% # drops to 3687
    left_join( select(seed_list, c(id, query_word=words)), by="id") %>% 
    select(id, query_word, everything()) %>% 
    mutate(tags=as.character(tags)) %>% 
    separate(tags, sep = ",", into = c("tag1", "tag2", "tag3", "tag4")) %>% 
    mutate_at(vars(tag1,tag2,tag3,tag4), .funs = function(x){
              str_extract(string=x, pattern =  regex("(?<=\")[[:alnum:]]+(?=\")"))})


# write_csv(crime_fear_lexicon,"../data/FOC_lexicon_001.csv")

# read locke data some web api package development lessons 
```

```{r}
lexicon_filtered <- read_csv("../data/FOC_lexicon_001_manual.csv") %>% 
    filter(remove==0) # rows to be removed was labelled as 1, rest was 0

lexicon_filtered

write_csv(lexicon_filtered, "../data/FOC_lexicon_001_manual_edited.csv")
```

